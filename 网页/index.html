<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SupNice</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- 配置Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <!-- 自定义工具类 -->
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .page-transition {
                transition: transform 0.5s ease-in-out;
            }
            .draggable-circle {
                transition: all 0.2s ease-out;
                cursor: grab;
            }
            .draggable-circle:active {
                cursor: grabbing;
            }
            .shape {
                position: absolute;
                transition: transform 0.2s, opacity 0.5s;
            }
        }
    </style>
</head>
<body class="bg-white m-0 p-0 overflow-hidden font-sans">
    <!-- 页面容器 -->
    <div id="app-container" class="relative w-full h-screen max-w-md mx-auto bg-white shadow-xl overflow-hidden">
        <!-- 页面内容 -->
        <div id="pages-container" class="relative w-full h-full">
            <!-- 第1页 -->
            <div class="page absolute inset-0 flex flex-col items-center justify-center page-transition" data-page="1">
                <h1 class="text-[clamp(2rem,5vw,3rem)] font-bold mb-4 text-primary">SupNice</h1>
                <div class="w-[90%] h-[60%] bg-gray-200 rounded-lg mb-8 flex items-center justify-center">
                    <img id="page1-image" src="https://picsum.photos/600/800" alt="页面1图片" class="max-w-full max-h-full object-contain">
                </div>
                <div class="scroll-indicator absolute bottom-8 w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center cursor-pointer" data-next-page="2">
                    <i class="fa fa-chevron-down text-primary"></i>
                </div>
            </div>
            
            <!-- 第2页 -->
            <div class="page absolute inset-0 flex flex-col items-center justify-center page-transition opacity-0 pointer-events-none" data-page="2">
                <h2 class="text-2xl font-bold mb-4">第2页</h2>
                <div class="w-[90%] h-[60%] bg-gray-200 rounded-lg mb-8 flex items-center justify-center">
                    <img id="page2-image" src="https://picsum.photos/600/801" alt="页面2图片" class="max-w-full max-h-full object-contain">
                </div>
                <div class="scroll-indicator absolute bottom-8 w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center cursor-pointer" data-next-page="3">
                    <i class="fa fa-chevron-down text-primary"></i>
                </div>
            </div>
            
            <!-- 第3页 -->
            <div class="page absolute inset-0 flex flex-col items-center justify-center page-transition opacity-0 pointer-events-none" data-page="3">
                <h2 class="text-2xl font-bold mb-4">第3页</h2>
                <div class="w-[90%] h-[60%] bg-gray-200 rounded-lg mb-8 flex items-center justify-center">
                    <img id="page3-image" src="https://picsum.photos/600/802" alt="页面3图片" class="max-w-full max-h-full object-contain">
                </div>
                <div class="scroll-indicator absolute bottom-8 w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center cursor-pointer" data-next-page="4">
                    <i class="fa fa-chevron-down text-primary"></i>
                </div>
            </div>
            
            <!-- 第4页 -->
            <div class="page absolute inset-0 flex flex-col items-center justify-center page-transition opacity-0 pointer-events-none" data-page="4">
                <h2 class="text-2xl font-bold mb-4">第4页</h2>
                <div class="w-[90%] h-[60%] bg-gray-200 rounded-lg mb-8 flex items-center justify-center">
                    <img id="page4-image" src="https://picsum.photos/600/803" alt="页面4图片" class="max-w-full max-h-full object-contain">
                </div>
                <div class="scroll-indicator absolute bottom-8 w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center cursor-pointer" data-next-page="5">
                    <i class="fa fa-chevron-down text-primary"></i>
                </div>
            </div>
            
            <!-- 第5页 -->
            <div class="page absolute inset-0 flex flex-col items-center justify-center page-transition opacity-0 pointer-events-none" data-page="5">
                <h2 class="text-2xl font-bold mb-4">第5页</h2>
                <div class="w-[90%] h-[60%] bg-gray-200 rounded-lg mb-8 flex items-center justify-center">
                    <img id="page5-image" src="https://picsum.photos/600/804" alt="页面5图片" class="max-w-full max-h-full object-contain">
                </div>
                <div class="scroll-indicator absolute bottom-8 w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center cursor-pointer" data-next-page="game">
                    <i class="fa fa-chevron-down text-primary"></i>
                </div>
            </div>
            
            <!-- 游戏页面 -->
            <div id="game-page" class="page absolute inset-0 page-transition opacity-0 pointer-events-none bg-gray-100" data-page="game">
                <h2 class="text-2xl font-bold text-center mt-4">游戏时间</h2>
                <div id="game-container" class="relative w-full h-[80%] mx-auto bg-white border border-gray-200 rounded-lg overflow-hidden">
                    <!-- 游戏区域 -->
                </div>
                <div id="game-message" class="text-center mt-4 font-medium"></div>
            </div>
            
            <!-- 结束页面 -->
            <div id="end-page" class="page absolute inset-0 flex flex-col items-center justify-center page-transition opacity-0 pointer-events-none" data-page="end">
                <h2 class="text-3xl font-bold mb-4 text-primary">恭喜完成!</h2>
                <p class="text-lg mb-8">你成功完成了所有挑战!</p>
                <button id="restart-button" class="px-6 py-3 bg-primary text-white rounded-lg shadow-lg hover:bg-primary/90 transition-colors">
                    重新开始
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 页面管理
            const pages = document.querySelectorAll('.page');
            let currentPage = 1;
            let totalPages = pages.length - 2; // 减去游戏页面和结束页面
            
            // 图片上传说明
            console.log('图片上传说明: 请将您准备好的图片分别命名为page1.jpg, page2.jpg, page3.jpg, page4.jpg, page5.jpg，然后将这些图片文件与本HTML文件放在同一个目录下。');
            
            // 页面切换功能
            function goToPage(pageNumber) {
                // 隐藏所有页面
                pages.forEach(page => {
                    page.classList.add('opacity-0', 'pointer-events-none');
                });
                
                // 显示当前页面
                const targetPage = document.querySelector(`[data-page="${pageNumber}"]`);
                if (targetPage) {
                    targetPage.classList.remove('opacity-0', 'pointer-events-none');
                    currentPage = pageNumber;
                    
                    // 如果是游戏页面，初始化游戏
                    if (pageNumber === 'game') {
                        initGame();
                    }
                }
            }
            
            // 绑定页面切换事件
            document.querySelectorAll('.scroll-indicator').forEach(indicator => {
                indicator.addEventListener('click', function() {
                    const nextPage = this.getAttribute('data-next-page');
                    goToPage(nextPage);
                });
            });
            
            // 游戏相关变量
            const gameContainer = document.getElementById('game-container');
            const gameMessage = document.getElementById('game-message');
            let circles = [];
            let shapes = [];
            let isDragging = false;
            let currentCircle = null;
            let velocityX = 0;
            let velocityY = 0;
            let lastX = 0;
            let lastY = 0;
            
            // 游戏初始化
            function initGame() {
                // 清空游戏容器
                gameContainer.innerHTML = '';
                circles = [];
                shapes = [];
                
                // 创建大型圆形
                createCircle('red', 100);
                createCircle('blue', 150);
                createCircle('green', 200);
                
                // 创建随机形状
                const shapeCount = Math.floor(Math.random() * 3) + 3; // 3-5个形状
                for (let i = 0; i < shapeCount; i++) {
                    const shapeTypes = ['trapezoid', 'diamond', 'square'];
                    const randomType = shapeTypes[Math.floor(Math.random() * shapeTypes.length)];
                    createShape(randomType);
                }
                
                // 显示游戏开始消息
                gameMessage.textContent = '拖动彩色圆形消除相应形状';
                
                // 绑定游戏事件
                bindGameEvents();
            }
            
            // 创建圆形
            function createCircle(color, size) {
                const circle = document.createElement('div');
                circle.className = `draggable-circle absolute rounded-full`;
                circle.style.width = `${size}px`;
                circle.style.height = `${size}px`;
                circle.style.backgroundColor = `${color}66`; // 半透明
                circle.style.border = `3px solid ${color}`;
                circle.style.left = `${Math.random() * (gameContainer.offsetWidth - size)}px`;
                circle.style.top = `${Math.random() * (gameContainer.offsetHeight - size)}px`;
                circle.dataset.type = color;
                
                // 存储圆形数据
                circles.push({
                    element: circle,
                    type: color,
                    size: size,
                    isDragging: false
                });
                
                gameContainer.appendChild(circle);
            }
            
            // 创建形状
            function createShape(type) {
                const shape = document.createElement('div');
                shape.className = `shape`;
                shape.dataset.type = type;
                
                const size = Math.floor(Math.random() * 30) + 40; // 40-70px
                const x = Math.random() * (gameContainer.offsetWidth - size);
                const y = Math.random() * (gameContainer.offsetHeight - size);
                
                // 设置形状样式
                switch(type) {
                    case 'trapezoid':
                        shape.style.width = `${size}px`;
                        shape.style.height = `0`;
                        shape.style.borderBottom = `${size}px solid #FF9800`;
                        shape.style.borderLeft = `${size/2}px solid transparent`;
                        shape.style.borderRight = `${size/2}px solid transparent`;
                        break;
                    case 'diamond':
                        shape.style.width = `0`;
                        shape.style.height = `0`;
                        shape.style.border = `${size/2}px solid transparent`;
                        shape.style.borderBottom = `${size}px solid #9C27B0`;
                        shape.style.top = `${y - size/2}px`;
                        shape.innerHTML = `<div style="position: absolute; top: ${size}px; left: -${size/2}px; width: 0; height: 0; border: ${size/2}px solid transparent; border-top: ${size}px solid #9C27B0;"></div>`;
                        break;
                    case 'square':
                        shape.style.width = `${size}px`;
                        shape.style.height = `${size}px`;
                        shape.style.backgroundColor = `#4CAF50`;
                        break;
                }
                
                shape.style.left = `${x}px`;
                shape.style.top = `${y}px`;
                
                // 存储形状数据
                shapes.push({
                    element: shape,
                    type: type,
                    size: size,
                    x: x,
                    y: y
                });
                
                gameContainer.appendChild(shape);
            }
            
            // 绑定游戏事件
            function bindGameEvents() {
                // 鼠标/触摸事件
                gameContainer.addEventListener('mousedown', startDrag);
                gameContainer.addEventListener('touchstart', startDrag, { passive: false });
                
                document.addEventListener('mousemove', drag);
                document.addEventListener('touchmove', drag, { passive: false });
                
                document.addEventListener('mouseup', endDrag);
                document.addEventListener('touchend', endDrag);
                
                // 游戏循环
                requestAnimationFrame(gameLoop);
            }
            
            // 开始拖动
            function startDrag(e) {
                e.preventDefault();
                const clientX = e.clientX || e.touches[0].clientX;
                const clientY = e.clientY || e.touches[0].clientY;
                
                const rect = gameContainer.getBoundingClientRect();
                const x = clientX - rect.left;
                const y = clientY - rect.top;
                
                // 检查是否点击了圆形
                for (let i = circles.length - 1; i >= 0; i--) {
                    const circle = circles[i];
                    const circleRect = circle.element.getBoundingClientRect();
                    const circleX = circleRect.left - rect.left + circleRect.width / 2;
                    const circleY = circleRect.top - rect.top + circleRect.height / 2;
                    const radius = circleRect.width / 2;
                    
                    // 计算距离
                    const distance = Math.sqrt(Math.pow(x - circleX, 2) + Math.pow(y - circleY, 2));
                    
                    if (distance <= radius) {
                        isDragging = true;
                        currentCircle = circle;
                        circle.isDragging = true;
                        velocityX = 0;
                        velocityY = 0;
                        lastX = x;
                        lastY = y;
                        
                        // 提升被拖动的圆形层级
                        circle.element.style.zIndex = '10';
                        break;
                    }
                }
            }
            
            // 拖动
            function drag(e) {
                if (!isDragging) return;
                e.preventDefault();
                
                const clientX = e.clientX || e.touches[0].clientX;
                const clientY = e.clientY || e.touches[0].clientY;
                
                const rect = gameContainer.getBoundingClientRect();
                const x = clientX - rect.left;
                const y = clientY - rect.top;
                
                // 计算速度
                velocityX = x - lastX;
                velocityY = y - lastY;
                lastX = x;
                lastY = y;
                
                // 移动圆形
                const circleSize = currentCircle.size;
                let newLeft = x - circleSize / 2;
                let newTop = y - circleSize / 2;
                
                // 边界检查
                newLeft = Math.max(0, Math.min(newLeft, gameContainer.offsetWidth - circleSize));
                newTop = Math.max(0, Math.min(newTop, gameContainer.offsetHeight - circleSize));
                
                currentCircle.element.style.left = `${newLeft}px`;
                currentCircle.element.style.top = `${newTop}px`;
            }
            
            // 结束拖动
            function endDrag(e) {
                if (!isDragging) return;
                e.preventDefault();
                
                isDragging = false;
                currentCircle.isDragging = false;
                currentCircle.element.style.zIndex = '5';
                currentCircle = null;
            }
            
            // 游戏循环
            function gameLoop() {
                // 处理圆形滑动
                if (!isDragging && circles.some(circle => !circle.isDragging)) {
                    circles.forEach(circle => {
                        if (!circle.isDragging) {
                            // 应用摩擦力减速
                            velocityX *= 0.95;
                            velocityY *= 0.95;
                            
                            // 如果速度很小，停止移动
                            if (Math.abs(velocityX) < 0.5) velocityX = 0;
                            if (Math.abs(velocityY) < 0.5) velocityY = 0;
                            
                            if (velocityX !== 0 || velocityY !== 0) {
                                const rect = gameContainer.getBoundingClientRect();
                                const circleSize = circle.size;
                                const circleRect = circle.element.getBoundingClientRect();
                                let newLeft = circleRect.left - rect.left + velocityX;
                                let newTop = circleRect.top - rect.top + velocityY;
                                
                                // 边界检查与碰撞反弹
                                if (newLeft < 0 || newLeft > gameContainer.offsetWidth - circleSize) {
                                    velocityX = -velocityX * 0.8;
                                    newLeft = Math.max(0, Math.min(newLeft, gameContainer.offsetWidth - circleSize));
                                }
                                
                                if (newTop < 0 || newTop > gameContainer.offsetHeight - circleSize) {
                                    velocityY = -velocityY * 0.8;
                                    newTop = Math.max(0, Math.min(newTop, gameContainer.offsetHeight - circleSize));
                                }
                                
                                circle.element.style.left = `${newLeft}px`;
                                circle.element.style.top = `${newTop}px`;
                            }
                        }
                    });
                }
                
                // 检测碰撞
                checkCollisions();
                
                // 检查游戏是否结束
                if (shapes.length === 0) {
                    gameMessage.textContent = '游戏完成!';
                    setTimeout(() => {
                        goToPage('end');
                    }, 2000);
                }
                
                requestAnimationFrame(gameLoop);
            }
            
            // 碰撞检测
            function checkCollisions() {
                circles.forEach(circle => {
                    const circleRect = circle.element.getBoundingClientRect();
                    const circleCenterX = circleRect.left + circleRect.width / 2;
                    const circleCenterY = circleRect.top + circleRect.height / 2;
                    const circleRadius = circleRect.width / 2;
                    
                    // 检查与形状的碰撞
                    for (let i = shapes.length - 1; i >= 0; i--) {
                        const shape = shapes[i];
                        const shapeRect = shape.element.getBoundingClientRect();
                        
                        // 根据形状类型计算碰撞
                        let isColliding = false;
                        
                        switch(shape.type) {
                            case 'trapezoid':
                            case 'square':
                                // 圆形与矩形碰撞检测
                                const rectCenterX = shapeRect.left + shapeRect.width / 2;
                                const rectCenterY = shapeRect.top + shapeRect.height / 2;
                                const rectHalfWidth = shapeRect.width / 2;
                                const rectHalfHeight = shapeRect.height / 2;
                                
                                // 计算圆形中心到矩形边缘的最近点
                                let closestX = Math.max(rectCenterX - rectHalfWidth, Math.min(circleCenterX, rectCenterX + rectHalfWidth));
                                let closestY = Math.max(rectCenterY - rectHalfHeight, Math.min(circleCenterY, rectCenterY + rectHalfHeight));
                                
                                // 计算最近点到圆形中心的距离
                                const distanceX = circleCenterX - closestX;
                                const distanceY = circleCenterY - closestY;
                                const distance = Math.sqrt(distanceX * distanceX + distanceY * distanceY);
                                
                                isColliding = distance <= circleRadius;
                                break;
                            case 'diamond':
                                // 圆形与菱形碰撞检测
                                // 简化为矩形碰撞检测（足够接近）
                                const diamondWidth = shapeRect.width;
                                const diamondHeight = shapeRect.height;
                                const diamondCenterX = shapeRect.left + diamondWidth / 2;
                                const diamondCenterY = shapeRect.top + diamondHeight / 2;
                                
                                // 计算圆形中心到菱形中心的向量
                                const dx = Math.abs(circleCenterX - diamondCenterX);
                                const dy = Math.abs(circleCenterY - diamondCenterY);
                                
                                // 计算菱形的半宽和半高
                                const diamondHalfWidth = diamondWidth / 2;
                                const diamondHalfHeight = diamondHeight / 2;
                                
                                // 检查是否在菱形边界内
                                const lineValue = (dx / diamondHalfWidth) + (dy / diamondHalfHeight);
                                isColliding = lineValue <= 1 || Math.hypot(dx, dy) <= circleRadius;
                                break;
                        }
                        
                        // 检查是否需要消除形状
                        if (isColliding) {
                            // 红色圆形消除梯形
                            if (circle.type === 'red' && shape.type === 'trapezoid') {
                                removeShape(i);
                            }
                            // 蓝色圆形消除菱形
                            else if (circle.type === 'blue' && shape.type === 'diamond') {
                                removeShape(i);
                            }
                            // 绿色圆形消除正方形
                            else if (circle.type === 'green' && shape.type === 'square') {
                                removeShape(i);
                            }
                        }
                    }
                });
            }
            
            // 移除形状
            function removeShape(index) {
                const shape = shapes[index];
                shape.element.style.opacity = '0';
                
                setTimeout(() => {
                    if (shape.element.parentNode) {
                        shape.element.parentNode.removeChild(shape.element);
                    }
                    shapes.splice(index, 1);
                }, 500);
            }
            
            // 重新开始按钮
            document.getElementById('restart-button').addEventListener('click', function() {
                goToPage(1);
            });
            
            // 初始化第一页
            goToPage(1);
        });
    </script>
</body>
</html>
    